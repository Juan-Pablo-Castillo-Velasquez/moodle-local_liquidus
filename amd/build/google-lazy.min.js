define(["jquery","core/log","core/templates"],function(a,b,c){var d=this,e={};return d.addAnalyticsJS=function(){var f=a.Deferred(),g=e.trackerInfo.siteid;if(!g)return void b.debug("Liquidus is misconfigured for Google, Site ID is missing.");var h=[];return h.siteid=g,c.render("local_liquidus/gtag",h).then(function(b){return a("body").append(b),"undefined"==typeof gtag?void f.fail():(d.gtag=gtag,void f.resolve())}),f},e.loadTracker=function(a){return e.trackerInfo=a,d.addAnalyticsJS()},e.identify=function(){b.debug("Identifying with Google"),d.gtag("event","identify",{userHash:e.trackerInfo.staticShares.userHash})},e.trackPage=function(){d.gtag("event","page",e.trackerInfo.staticShares)},e.processEvent=function(a,b,c){d.gtag("event",b,{userHash:e.trackerInfo.staticShares.userHash,eventData:c,event_callback:function(){a.resolve()}})},e});