define(["jquery","core/log"],function(a,b){var c=this,d={},e={};return c.addAnalyticsJS=function(){var e=a.Deferred(),f=d.trackerInfo.writeKey;return f?(!function(){var a=window.analytics=window.analytics||[];if(!a.initialize)if(a.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{a.invoked=!0,a.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"],a.factory=function(b){return function(){var c=Array.prototype.slice.call(arguments);return c.unshift(b),a.push(c),a}};for(var b=0;b<a.methods.length;b++){var g=a.methods[b];a[g]=a.factory(g)}a.load=function(b,c){var d=document.createElement("script");d.type="text/javascript",d.async=!0,d.src="https://cdn.segment.com/analytics.js/v1/"+b+"/analytics.min.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(d,e),a._loadOptions=c},a.SNIPPET_VERSION="4.1.0",c.analytics=a,a.load(f),e.resolve(d)}}(),e):void b.debug("Liquidus is misconfigured for Segment, Write Key is missing.")},d.loadTracker=function(a){return d.trackerInfo=a,c.addAnalyticsJS()},d.identify=function(){b.debug("Identifying with segment"),c.analytics.identify(d.trackerInfo.staticShares.userHash,d.trackerInfo.staticShares)},d.trackPage=function(){c.analytics.page()},d.processEvent=function(a,f,g){c.analytics.track(f,{userHash:d.trackerInfo.staticShares.userHash,eventData:g},e,function(){a.resolve(!0),b.debug("Segment resolved.")})},d});